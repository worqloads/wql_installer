var a1a=['agent_moni','apply','pushInstance\x20error:','stdout','pm2-logrotate','parse','pm2_env','\x22,user=\x22','cpu','pm_uptime','spawn','prototype','push','filter','set','status','\x22,scaler=\x22','data','I\x20Scaler\x20Mon\x20!\x20About\x20to\x20exit\x20with\x20code\x20','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','restart_time','pm2','memory','/instance/','return\x20/\x22\x20+\x20this\x20+\x20\x22/','E\x20missing\x20configuration\x20file:','\x22,agent=\x22','://','env','exit','jlist','catch','protocole','USER','existsSync','json_res:','test','\x20gauge\x0a','host','keys','/conf.json','length','object','log','default','cpu_used','gateway','post','name','end','code','Exception\x20raised:','axios','WQL_DEBUG','credentials','constructor','error','0\x20*/5\x20*\x20*\x20*\x20*','gtw_url','/moni','mem_used','metrics_caches','async','cron'];(function(a,b){var c=function(g){while(--g){a['push'](a['shift']());}};var e=function(){var g={'data':{'key':'cookie','value':'timeout'},'setCookie':function(k,l,m,n){n=n||{};var o=l+'='+m;var p=0x0;for(var q=0x0,r=k['length'];q<r;q++){var s=k[q];o+=';\x20'+s;var t=k[s];k['push'](t);r=k['length'];if(t!==!![]){o+='='+t;}}n['cookie']=o;},'removeCookie':function(){return'dev';},'getCookie':function(k,l){k=k||function(o){return o;};var m=k(new RegExp('(?:^|;\x20)'+l['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var n=function(o,p){o(++p);};n(c,b);return m?decodeURIComponent(m[0x1]):undefined;}};var h=function(){var k=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return k['test'](g['removeCookie']['toString']());};g['updateCookie']=h;var i='';var j=g['updateCookie']();if(!j){g['setCookie'](['*'],'counter',0x1);}else if(j){i=g['getCookie'](null,'counter');}else{g['removeCookie']();}};e();}(a1a,0x195));var a1b=function(a,b){a=a-0x0;var c=a1a[a];return c;};'use strict';function _interopDefault(a){return a&&typeof a===a1b('0x15')&&'default'in a?a[a1b('0x17')]:a;}var fs=_interopDefault(require('fs'));var cron=_interopDefault(require(a1b('0x2a')));var child_process=_interopDefault(require('child_process'));var axios=_interopDefault(require(a1b('0x1f')));var async=_interopDefault(require(a1b('0x29')));var config_file=__dirname+a1b('0x13');try{if(!fs[a1b('0xd')](config_file)){console[a1b('0x23')](a1b('0x4'),config_file);throw{'code':0x2};}else{var localconf=JSON['parse'](fs['readFileSync'](config_file));var myenv=process[a1b('0x7')]['NODE_ENV']||'production';scaler_mon(localconf[myenv]);}}catch(a1c){console[a1b('0x23')](a1b('0x1e'),a1c[a1b('0x1d')]||a1c);process[a1b('0x8')](0x1);}process['on']('exit',function(a){return console[a1b('0x16')](a1b('0x3d')+a);});function scaler_mon(c){var d=function(){var k=!![];return function(l,m){var n=k?function(){if(m){var o=m[a1b('0x2c')](l,arguments);m=null;return o;}}:function(){};k=![];return n;};}();var f=d(this,function(){var k=function(){var l=k[a1b('0x22')](a1b('0x3'))()['compile'](a1b('0x3e'));return!l[a1b('0xf')](f);};return k();});f();var g=new PushCli(c[a1b('0x19')][a1b('0xb')]+a1b('0x6')+(c[a1b('0x19')][a1b('0x21')]?c[a1b('0x19')][a1b('0x21')]+'@':'')+c[a1b('0x19')][a1b('0x11')]+':'+c[a1b('0x19')]['port']+a1b('0x26'));var h=a1b('0x24');var i=c['company'];var j=c['agent'];new cron['CronJob'](h,function(){var k=process[a1b('0x7')][a1b('0x20')]||![];var l=child_process[a1b('0x35')](a1b('0x0'),[a1b('0x9')]);var m='';l[a1b('0x2e')]['on'](a1b('0x3c'),function(n){m+=n;});l['stdout']['on'](a1b('0x1c'),function(){if(m){var n=JSON[a1b('0x30')](m);if(k){console['log'](a1b('0xe'),n);}n[a1b('0x38')](function(o){return o[a1b('0x1b')]!=a1b('0x2f');})['forEach'](function(o){var p='{instance=\x22'+i+a1b('0x5')+j+a1b('0x3b')+o[a1b('0x1b')]+a1b('0x32')+o[a1b('0x31')][a1b('0xc')]+'\x22}';if(k){console[a1b('0x16')]('push\x20moni:',p);}g[a1b('0x39')](p,a1b('0x3a'),o[a1b('0x31')][a1b('0x3a')]=='online'?0x1:0x0);g[a1b('0x39')](p,a1b('0x3f'),o[a1b('0x31')][a1b('0x3f')]);g['set'](p,a1b('0x34'),o['pm2_env'][a1b('0x34')]);g[a1b('0x39')](p,a1b('0x18'),o['monit'][a1b('0x33')]);g[a1b('0x39')](p,a1b('0x27'),o['monit'][a1b('0x1')]);});}g['pushInstance'](a1b('0x2b'),i);});})['start']();}function PushCli(a){this['gtw_url']=a;this[a1b('0x28')]={};}PushCli[a1b('0x36')]={'Constructor':PushCli,'pushInstance':function pushInstance(a,b){var c=this;var d=Object[a1b('0x12')](c[a1b('0x28')])[a1b('0x38')](function(f){return c[a1b('0x28')][f][a1b('0x14')]>0x0;});async['each'](d,function(f,g){var h='#\x20TYPE\x20'+f+a1b('0x10')+c['metrics_caches'][f]['map'](function(i){return f+'\x20'+i;})['join']('\x0a')+'\x0a';axios[a1b('0x1a')](c[a1b('0x25')]+encodeURIComponent('/metrics/job/'+a+a1b('0x2')+b),h)[a1b('0xa')](function(i){console[a1b('0x23')](a1b('0x2d'),i);})['finally'](function(){c[a1b('0x28')][f]=[];g();});},function(f){c[a1b('0x28')]={};});},'set':function set(a,b,c){var d=this;var f=c==null||isNaN(c)?0x0:parseInt(c);if(!d[a1b('0x28')][b])d[a1b('0x28')][b]=[];d[a1b('0x28')][b][a1b('0x37')](a+'\x20'+f);}};