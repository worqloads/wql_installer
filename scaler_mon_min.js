var a1a=['\x22\x20is\x20read-only','parse','set','exit','existsSync','metrics_caches','length','\x22,user=\x22','child_process','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','finally','catch','\x22,scaler=\x22','/agent/','memory','USER','name','compile','gtw_url','pm2-logrotate','online','/instance/','pm_uptime','status','gateway','cpu','{instance=\x22','pushInstance\x20error:','mem_used','pushInstance','start','I\x20Scaler\x20Mon\x20!\x20About\x20to\x20exit\x20with\x20code\x20','monit','default','env','cpu_used','each','json_res:','error','NODE_ENV','filter','join','post','restart_time','E\x20missing\x20configuration\x20file:','port','async','#\x20TYPE\x20','push','code','forEach','spawn','jlist','axios','end','/conf.json','WQL_DEBUG','production','prototype','map','company','/moni','object','keys','stdout','protocole','CronJob','log','data','test','pm2_env','agent_moni','json_res'];(function(a,b){var c=function(g){while(--g){a['push'](a['shift']());}};var e=function(){var g={'data':{'key':'cookie','value':'timeout'},'setCookie':function(k,l,m,n){n=n||{};var o=l+'='+m;var p=0x0;for(var q=0x0,r=k['length'];q<r;q++){var s=k[q];o+=';\x20'+s;var t=k[s];k['push'](t);r=k['length'];if(t!==!![]){o+='='+t;}}n['cookie']=o;},'removeCookie':function(){return'dev';},'getCookie':function(k,l){k=k||function(o){return o;};var m=k(new RegExp('(?:^|;\x20)'+l['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var n=function(o,p){o(++p);};n(c,b);return m?decodeURIComponent(m[0x1]):undefined;}};var h=function(){var k=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return k['test'](g['removeCookie']['toString']());};g['updateCookie']=h;var i='';var j=g['updateCookie']();if(!j){g['setCookie'](['*'],'counter',0x1);}else if(j){i=g['getCookie'](null,'counter');}else{g['removeCookie']();}};e();}(a1a,0x1dc));var a1b=function(a,b){a=a-0x0;var c=a1a[a];return c;};'use strict';function _interopDefault(c){var d=function(){var g=!![];return function(h,i){var j=g?function(){if(i){var k=i['apply'](h,arguments);i=null;return k;}}:function(){};g=![];return j;};}();var f=d(this,function(){var g=function(){var h=g['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a1b('0x34')](a1b('0x2c'));return!h[a1b('0x1f')](f);};return g();});f();return c&&typeof c===a1b('0x18')&&a1b('0x44')in c?c[a1b('0x44')]:c;}var fs=_interopDefault(require('fs'));var cron=_interopDefault(require('cron'));var child_process=_interopDefault(require(a1b('0x2b')));var axios=_interopDefault(require(a1b('0xf')));var async=_interopDefault(require(a1b('0x8')));function _readOnlyError(a){throw new Error('\x22'+a+a1b('0x23'));}var config_file=__dirname+a1b('0x11');try{if(!fs[a1b('0x27')](config_file)){console[a1b('0x0')](a1b('0x6'),config_file);throw{'code':0x2};}else{var localconf=JSON[a1b('0x24')](fs['readFileSync'](config_file));var myenv=process[a1b('0x45')][a1b('0x1')]||a1b('0x13');scaler_mon(localconf[myenv]);}}catch(a1c){console['error']('Exception\x20raised:',a1c[a1b('0xb')]||a1c);process['exit'](0x1);}process['on'](a1b('0x26'),function(a){return console[a1b('0x1d')](a1b('0x42')+a);});function scaler_mon(a){function b(f){this[a1b('0x35')]=f;this[a1b('0x28')]={};}b[a1b('0x14')]={'Constructor':b,'pushInstance':function f(g,h,i){var j=this;var k=Object[a1b('0x19')](j[a1b('0x28')])[a1b('0x2')](function(l){return j[a1b('0x28')][l][a1b('0x29')]>0x0;});async[a1b('0x47')](k,function(l,m){var n=a1b('0x9')+l+'\x20gauge\x0a'+j[a1b('0x28')][l][a1b('0x15')](function(o){return l+'\x20'+o;})[a1b('0x3')]('\x0a')+'\x0a';axios[a1b('0x4')](j[a1b('0x35')]+encodeURIComponent('/metrics/job/'+g+a1b('0x38')+h+a1b('0x30')+i),n)[a1b('0x2e')](function(o){console[a1b('0x0')](a1b('0x3e'),o);})[a1b('0x2d')](function(){j[a1b('0x28')][l]=[];m();});},function(l){k=null;j[a1b('0x28')]={};});},'set':function g(h,i,j){var k=this;var l=j==null||isNaN(j)?0x0:parseInt(j);if(!k[a1b('0x28')][i])k['metrics_caches'][i]=[];k[a1b('0x28')][i][a1b('0xa')](h+'\x20'+l);}};var c=new b(a[a1b('0x3b')][a1b('0x1b')]+'://'+(a[a1b('0x3b')]['credentials']?a[a1b('0x3b')]['credentials']+'@':'')+a['gateway']['host']+':'+a['gateway'][a1b('0x7')]+a1b('0x17'));var d='0\x20*/5\x20*\x20*\x20*\x20*';new cron[(a1b('0x1c'))](d,function(){var h=process[a1b('0x45')][a1b('0x12')]||![];var i=child_process[a1b('0xd')]('pm2',[a1b('0xe')]);var j='';i[a1b('0x1a')]['on'](a1b('0x1e'),function(k){j+=k;});i[a1b('0x1a')]['on'](a1b('0x10'),function(){if(j){var k=JSON[a1b('0x24')](j);j=null;if(h){console['log'](a1b('0x48'),k);}k['filter'](function(l){return l[a1b('0x33')]!=a1b('0x36');})[a1b('0xc')](function(l){var m=a1b('0x3d')+a[a1b('0x16')]+a1b('0x2f')+l[a1b('0x33')]+a1b('0x2a')+l[a1b('0x20')][a1b('0x32')]+'\x22}';if(h){console[a1b('0x1d')]('push\x20moni:',m);}c[a1b('0x25')](m,a1b('0x3a'),l[a1b('0x20')]['status']==a1b('0x37')?0x1:0x0);c[a1b('0x25')](m,a1b('0x5'),l[a1b('0x20')][a1b('0x5')]);c[a1b('0x25')](m,a1b('0x39'),l[a1b('0x20')][a1b('0x39')]);c[a1b('0x25')](m,a1b('0x46'),l[a1b('0x43')][a1b('0x3c')]);c[a1b('0x25')](m,a1b('0x3f'),l[a1b('0x43')][a1b('0x31')]);});k=(_readOnlyError(a1b('0x22')),null);c[a1b('0x40')](a1b('0x21'),a[a1b('0x16')],a['agent']);}});})[a1b('0x41')]();}